"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[376],{30376:function(e,t,i){i.r(t),i.d(t,{default:function(){return C}});var a,n,l=i(9268),r=i(9793),s=i(84257),d=i(86006),c=i(61971),o=i(75228),E=i(85505),u=i(14453),y=i(21511),w=i(9384),S=i(71327),x=i(3906),h=i(47337),T=i(20763),p=i(50828),f=i(24245),v=i(23823),m=i(93400),g=i(89791),j=e=>{let t=(0,g.Z)({"text-indigo-500":e.active,"bg-zinc-800":e.active});return(0,l.jsxs)("button",{...e,className:"flex flex-col justify-center items-center gap-y-2 p-2 rounded-md hover:bg-zinc-800 ".concat(t," ").concat(e.className||""),children:[e.icon,e.children]})},_=i(30308),L=i(72875);(a=n||(n={})).SET_WYSIWYG="SET_WYSIWYG",a.SET_MD="SET_MD",a.SET_LABELS="SET_LABELS",a.SET_FAVORITE="SET_FAVORITE",a.SET_TITLE="SET_TITLE",a.SET_TYPE="SET_TYPE",a.SET_LABEL_VALUE="SET_LABEL_VALUE",a.SET_FOCUSED="SET_FOCUSED",a.RESET="RESET",a.SET_STATE="SET_STATE";let b={title:"",editorState:{markdown:"",wysiwyg:p.EditorState.createEmpty()},type:"wysiwyg",favorite:!1,labels:[],labelValue:"",focused:!1};function k(e,t){let{type:i,payload:a}=t;switch(i){case n.SET_WYSIWYG:return{...e,editorState:{markdown:e.editorState.markdown,wysiwyg:a}};case n.SET_MD:return{...e,editorState:{markdown:a,wysiwyg:e.editorState.wysiwyg}};case n.SET_TITLE:return{...e,title:a};case n.SET_FAVORITE:return{...e,favorite:a};case n.SET_FOCUSED:return{...e,focused:a};case n.SET_LABELS:return{...e,labels:a};case n.SET_LABEL_VALUE:return{...e,labelValue:a};case n.SET_TYPE:return{...e,type:a};case n.RESET:return b;case n.SET_STATE:return a;default:return e}}var N=i(36738);let A=()=>window.innerWidth<=768;var C=e=>{let t=e.refetch,i=(0,r.r)(),[a,C,Z,I,V,D,O]=(0,_.Z)(e=>[e.editingNote,e.setEditingNote,e.notes,e.isViewing,e.setIsViewing,e.isEditing,e.setEditing]),[Y]=(0,_.Z)(e=>[e.localMode]),{value:B,set:F}=(0,N.Z)("notes",{defaultValue:[],initializeWithValue:!0}),R=function(){let[e,t]=(0,d.useState)(A());return(0,d.useEffect)(()=>{let e=()=>{t(A())};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}(),U=Z[a||0],M=(0,_.Z)(e=>e.setSelectedMode);(0,_.Z)(e=>e.setSidebarOpen);let W=(0,_.Z)(e=>e.supabase),z=(0,_.Z)(e=>e.session),[P,G]=(0,d.useState)(!1),[{title:J,editorState:q,favorite:H,type:K,labels:$,labelValue:Q,focused:X},ee]=(0,d.useReducer)(k,b);function et(){ee({type:n.RESET}),C(null),V(!1),O(!1)}async function ei(){let e={archived:!1,content:"wysiwyg"==K?JSON.stringify((0,p.convertToRaw)(q.wysiwyg.getCurrentContent())):q[K],editor:K,created:new Date().getTime(),favorite:H,labels:$,title:J,id:-1},i={data:e,uid:null==z?void 0:z.user.id};if(Y&&(e.id=crypto.randomUUID()),D){if(e.id=U.id,e.created=U.created,e.archived=U.archived,Y&&B){let t=B.findIndex(e=>e.id===U.id),i=[...B];i[t]=e,F(i)}else await W.from("Notes").update(i).eq("id",e.id)}else Y?F([...B||[],e]):await W.from("Notes").upsert(i);t(),M(1),et()}let ea=(0,d.useRef)(null);(0,d.useEffect)(()=>{if(I||D){let e=U.content,t="";"wysiwyg"===U.editor?e=p.EditorState.createWithContent((0,p.convertFromRaw)(JSON.parse(U.content))):(e=p.EditorState.createEmpty(),t=U.content);let i={editorState:{markdown:t,wysiwyg:e},favorite:U.favorite,focused:!1,labels:U.labels,title:U.title,type:U.editor,labelValue:Q};ee({type:n.SET_STATE,payload:i})}},[I,D]);let en=R?"20vh":"35vh";return(0,l.jsxs)("div",{className:"flex-col h-screen gap-y-2 overflow-hidden flex py-16 md:py-8  w-full",children:[(0,l.jsx)("div",{children:(0,l.jsxs)("button",{onClick:()=>{M(1),et()},className:"flex items-center justify-center gap-x-2",children:[(0,l.jsx)(c.Z,{}),(0,l.jsx)("div",{children:"Back"})]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{children:"Title"}),(0,l.jsx)(L.I,{disabled:I,value:I&&U.title||J,onChange:e=>ee({type:n.SET_TITLE,payload:e.currentTarget.value}),placeholder:"Title"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{children:["Labels ",!I&&(0,l.jsx)("span",{children:"(up to 5) "})," "]}),(0,l.jsxs)("div",{className:"flex rounded-md p-2 my-2  gap-x-2 border border-zinc-600 ".concat((0,g.Z)({"border-indigo-500":X})),children:[(I&&U.labels||$).map((e,t)=>(0,l.jsxs)("div",{className:"rounded-md border-zinc-500 border whitespace-nowrap flex gap-x-2 items-center justify-center bg-zinc-900 p-2",children:[e,!I&&(0,l.jsx)("button",{onClick:()=>{ee({type:n.SET_LABELS,payload:$.filter((e,i)=>t!==i)})},children:(0,l.jsx)(o.Z,{})})]},t)),!I&&$.length<5&&(0,l.jsx)(L.I,{disabled:I,onFocus:e=>{ee({type:n.SET_FOCUSED,payload:!0})},onBlur:()=>{ee({type:n.SET_FOCUSED,payload:!1})},value:Q,placeholder:"Enter labels",onChange:e=>ee({type:n.SET_LABEL_VALUE,payload:e.currentTarget.value}),onKeyDown:e=>{"Enter"===e.key&&Q.length>0&&(ee({type:n.SET_LABEL_VALUE,payload:""}),ee({type:n.SET_LABELS,payload:Array.from(new Set([...$,Q]))}))},className:"border-none outline-0 outline-none px-2"})]})]}),(0,l.jsxs)(r.I,{handle:i,children:[(0,l.jsxs)("div",{className:"h-full flex flex-col",children:[(0,l.jsx)("div",{className:"flex w-full items-end justify-end p-4 ",children:(0,l.jsx)("button",{className:"p-2 z-50",onClick:i.active?i.exit:i.enter,children:(0,l.jsx)(E.Z,{})})}),"markdown"===K&&!P&&!I&&(0,l.jsx)(s.ML,{onChange:e=>{ee({type:n.SET_MD,payload:e})},theme:"vs-dark",width:"100%",height:i.active?"100vh":en,value:q.markdown,defaultLanguage:"markdown"}),"markdown"===K&&(I||P)&&(0,l.jsx)("div",{style:{height:R?"100vh":en},className:"w-full overflow-y-scroll test-class",children:(0,l.jsx)(v.D,{remarkPlugins:[m.Z],components:{code(e){let{node:t,inline:i,className:a,children:n,...r}=e,s=/language-(\w+)/.exec(a||"");return!i&&s?(0,l.jsx)(h.Z,{...r,style:T.Z,language:s[1],PreTag:"div",children:String(n).replace(/\n$/,"")}):(0,l.jsx)("code",{...r,className:a,children:n})}},children:I&&"markdown"===U.editor&&U.content||q.markdown})}),"wysiwyg"===K&&(0,l.jsx)(f.Editor,{ref:ea,readOnly:P||I,wrapperStyle:{height:i.active?"80vh":en,maxHeight:i.active?"80vh":en},editorState:q.wysiwyg,editorClassName:"w-full py-16",toolbarClassName:"text-black ".concat((P||I)&&"opacity-0"),onEditorStateChange:e=>ee({type:n.SET_WYSIWYG,payload:e})})]}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between items-center md:text-base text-xs  px-4",children:[(0,l.jsxs)("div",{className:"w-full flex gap-x-3 ",children:[!I&&(0,l.jsx)(j,{onClick:()=>{ee({type:n.SET_FAVORITE,payload:!H})},active:H,icon:(0,l.jsx)(u.Z,{}),children:(0,l.jsx)("div",{children:"Favorite"})}),(I&&"wysiwyg"===K||D||!D&&!I)&&(0,l.jsx)(j,{active:"wysiwyg"===K,icon:(0,l.jsx)(y.Z,{}),onClick:()=>{ee({type:n.SET_TYPE,payload:"wysiwyg"})},children:(0,l.jsx)("div",{children:"Editor Mode"})}),(I&&"markdown"===K||D||!D&&!I)&&(0,l.jsxs)(j,{icon:"",active:"markdown"===K,onClick:()=>{ee({type:n.SET_TYPE,payload:"markdown"})},children:[(0,l.jsx)("div",{className:"italic",children:" MD "}),(0,l.jsx)("div",{children:"Markdown Mode"})]}),!I&&(0,l.jsx)(j,{icon:(0,l.jsx)(w.Z,{}),active:P,onClick:()=>{G(e=>!e)},children:(0,l.jsx)("div",{className:"whitespace-nowrap text-center",children:" Preview "})})]}),!I&&(0,l.jsx)(j,{onClick:ei,className:"md:w-auto w-full my-2 flex flex-row",icon:"",children:(0,l.jsxs)("div",{className:"flex  gap-x-2 whitespace-nowrap text-center",children:[(0,l.jsxs)("div",{children:[D&&(0,l.jsx)(S.Z,{}),!D&&(0,l.jsx)(x.Z,{})]})," ",D?"Save note":"Add note"," "]})})]})]})]})}}}]);
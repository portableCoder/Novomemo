"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[376],{30376:function(e,t,l){l.r(t),l.d(t,{default:function(){return A}});var i,n,a=l(9268),s=l(86462),d=l(84257),r=l(86006),c=l(75228),o=l(69888),u=l(14453),E=l(9384),x=l(71327),f=l(3906),T=l(47337),h=l(20763),p=l(23823),S=l(93400),v=l(89791),m=e=>{let{buttonActive:t,icon:l,children:i,className:n,...s}=e,d=(0,v.Z)({"text-indigo-500":t,"bg-zinc-800":t});return(0,a.jsxs)("button",{...s,className:"flex flex-col justify-center items-center gap-y-2 p-2 rounded-md hover:bg-zinc-800 ".concat(d," ").concat(n||""),children:[l,i]})},j=l(30308),w=l(72875);(i=n||(n={})).SET_MD="SET_MD",i.SET_LABELS="SET_LABELS",i.SET_FAVORITE="SET_FAVORITE",i.SET_TITLE="SET_TITLE",i.SET_LABEL_VALUE="SET_LABEL_VALUE",i.SET_FOCUSED="SET_FOCUSED",i.RESET="RESET",i.SET_STATE="SET_STATE";let _={title:"",data:"",favorite:!1,labels:[],labelValue:"",focused:!1};function y(e,t){let{type:l,payload:i}=t;switch(l){case n.SET_MD:return{...e,data:i};case n.SET_TITLE:return{...e,title:i};case n.SET_FAVORITE:return{...e,favorite:i};case n.SET_FOCUSED:return{...e,focused:i};case n.SET_LABELS:return{...e,labels:i};case n.SET_LABEL_VALUE:return{...e,labelValue:i};case n.RESET:return _;case n.SET_STATE:return i;default:return e}}var g=l(36738);let L=()=>window.innerWidth<=768;var A=e=>{let t=e.refetch,[l,i,v,A,b,N,Z]=(0,j.Z)(e=>[e.editingNote,e.setEditingNote,e.notes,e.isViewing,e.setIsViewing,e.isEditing,e.setEditing]),[C]=(0,j.Z)(e=>[e.localMode]),{value:k,set:V}=(0,g.Z)("notes",{defaultValue:[],initializeWithValue:!0}),D=function(){let[e,t]=(0,r.useState)(L());return(0,r.useEffect)(()=>{let e=()=>{t(L())};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}(),I=v[l||0],B=(0,j.Z)(e=>e.setSelectedMode),F=(0,j.Z)(e=>e.supabase),z=(0,j.Z)(e=>e.session),[U,O]=(0,r.useState)(!1),[{title:R,favorite:M,labels:P,labelValue:W,focused:q,data:K},$]=(0,r.useReducer)(y,_);function G(){$({type:n.RESET}),i(null),b(!1),Z(!1)}async function H(){let e={archived:!1,content:K,created:new Date().getTime(),favorite:M,labels:P,title:R,id:-1},l={data:e,uid:null==z?void 0:z.user.id};if(C&&(e.id=(0,s.Z)()),N&&I){if(e.id=I.id,e.created=I.created,e.archived=I.archived,C&&k){let t=k.findIndex(e=>e.id===I.id),l=[...k];l[t]=e,V(l)}else await F.from("Notes").update(l).eq("id",e.id)}else C?V([...k||[],e]):await F.from("Notes").upsert(l);t(),B(1),G()}return(0,r.useEffect)(()=>{if(A||N){if(I){let e={data:I.content,favorite:I.favorite,focused:!1,labels:I.labels,title:I.title,labelValue:W};$({type:n.SET_STATE,payload:e})}else $({type:n.SET_STATE,payload:{data:K,favorite:M,focused:!1,labels:P,title:R,labelValue:W}})}},[A,N]),(0,a.jsxs)("div",{className:"flex-col min-h-screen gap-y-2 overflow-hidden flex py-16 md:py-8 px-2  w-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Title"}),(0,a.jsx)(w.I,{disabled:A,value:A&&I.title||R,onChange:e=>$({type:n.SET_TITLE,payload:e.currentTarget.value}),placeholder:"Title"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:["Labels ",!A&&(0,a.jsx)("span",{children:"(up to 5) "})," "]}),(0,a.jsx)("div",{className:"flex gap-x-2 flex-wrap",children:(A&&I.labels||P).map((e,t)=>(0,a.jsxs)("div",{className:"rounded-md border-zinc-500 border whitespace-nowrap flex gap-x-2 items-center justify-center bg-zinc-900 p-2",children:[e,!A&&(0,a.jsx)("button",{onClick:()=>{$({type:n.SET_LABELS,payload:P.filter((e,l)=>t!==l)})},children:(0,a.jsx)(c.Z,{})})]},t))}),!A&&P.length<5&&(0,a.jsx)(w.I,{disabled:A,onFocus:e=>{$({type:n.SET_FOCUSED,payload:!0})},onBlur:()=>{$({type:n.SET_FOCUSED,payload:!1})},value:W,placeholder:"Enter labels",onChange:e=>$({type:n.SET_LABEL_VALUE,payload:e.currentTarget.value}),onKeyDown:e=>{let t=W.trim();"Enter"===e.key&&t.length>0&&($({type:n.SET_LABEL_VALUE,payload:""}),$({type:n.SET_LABELS,payload:Array.from(new Set([...P,W]))}))},className:"border-none outline-0 outline-none px-2"})]}),(0,a.jsxs)("div",{className:"h-full  flex flex-col",children:[!U&&!A&&(0,a.jsx)(d.ML,{onChange:e=>{$({type:n.SET_MD,payload:e})},className:"outline outline-1 outline-zinc-700 rounded-md focus:outline-indigo-600 ",theme:"vs-dark",width:"100%",height:D?"40vh":"50vh",value:K,defaultLanguage:"markdown"}),(A||U)&&(0,a.jsx)("div",{id:"check-test",className:"w-full h-full overflow-y-scroll test-class",children:(0,a.jsx)(p.D,{remarkPlugins:[S.Z],components:{code(e){let{node:t,inline:l,className:i,children:n,...s}=e,d=/language-(\w+)/.exec(i||"");return!l&&d?(0,a.jsx)(T.Z,{...s,style:h.Z,language:d[1],PreTag:"div",children:String(n).replace(/\n$/,"")}):(0,a.jsx)("code",{...s,className:i,children:n})}},children:K})})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between items-center md:text-base text-xs px-2 md:px-4",children:[(0,a.jsxs)("div",{className:"w-full flex gap-x-3 ",children:[(0,a.jsx)(m,{onClick:()=>{Z(!0),b(!1),O(!1)},buttonActive:N,icon:(0,a.jsx)(o.Z,{}),children:(0,a.jsx)("div",{children:"Edit"})}),!A&&(0,a.jsx)(m,{onClick:()=>{$({type:n.SET_FAVORITE,payload:!M})},buttonActive:M,icon:(0,a.jsx)(u.Z,{}),children:(0,a.jsx)("div",{children:"Favorite"})}),!A&&(0,a.jsx)(m,{icon:(0,a.jsx)(E.Z,{}),buttonActive:U,onClick:()=>{O(e=>!e)},children:(0,a.jsx)("div",{className:"whitespace-nowrap text-center",children:" Preview "})})]}),(0,a.jsx)(m,{icon:"",className:"md:w-auto w-full my-2 outline outline-1 outline-zinc-800 flex flex-row",onClick:()=>{B(1),G()},children:(0,a.jsxs)("div",{className:"flex  gap-x-2 items-center whitespace-nowrap text-center",children:[(0,a.jsx)("div",{children:(0,a.jsx)(c.Z,{})})," ","Close"]})}),!A&&(0,a.jsx)(m,{onClick:H,className:"md:w-auto w-full my-2 flex flex-row outline outline-1 outline-zinc-800 items-center",icon:"",children:(0,a.jsxs)("div",{className:"flex  gap-x-2 items-center whitespace-nowrap text-center",children:[(0,a.jsxs)("div",{children:[N&&(0,a.jsx)(x.Z,{}),!N&&(0,a.jsx)(f.Z,{})]})," ",N?"Save note":"Add note"," "]})})]})]})}}}]);